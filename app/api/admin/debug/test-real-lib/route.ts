import { NextRequest, NextResponse } from 'next/server';\n\nexport const dynamic = 'force-dynamic';\n\nexport async function GET() {\n  try {\n    console.log('üß™ === TEST NOUVELLE LIBRAIRIE EA SPORTS ===');\n    \n    const { EAFCApiService } = require('eafc-clubs-api');\n    const api = new EAFCApiService();\n    \n    const CLUB_ID = '40142'; // HOF 221\n    const PLATFORM = 'common-gen5'; // PS5\n    \n    console.log(`üéÆ Test pour club ${CLUB_ID} sur ${PLATFORM}`);\n    \n    const results: any = {\n      clubId: CLUB_ID,\n      platform: PLATFORM,\n      tests: []\n    };\n    \n    // Test 1: Club Info\n    console.log('1Ô∏è‚É£  Test Club Info...');\n    try {\n      const clubInfoResponse = await api.clubInfo({\n        clubIds: CLUB_ID,\n        platform: PLATFORM\n      });\n      \n      const clubInfo = clubInfoResponse[CLUB_ID];\n      results.tests.push({\n        name: 'Club Info',\n        success: !!clubInfo,\n        data: clubInfo ? {\n          name: clubInfo.name,\n          clubId: clubInfo.clubId,\n          teamId: clubInfo.teamId\n        } : null\n      });\n      \n      console.log(`   ${clubInfo ? '‚úÖ Succ√®s' : '‚ùå √âchec'}: ${clubInfo?.name || 'Pas de donn√©es'}`);\n    } catch (error) {\n      results.tests.push({\n        name: 'Club Info',\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error'\n      });\n      console.log(`   ‚ùå Erreur: ${error}`);\n    }\n    \n    // Test 2: Member Stats\n    console.log('2Ô∏è‚É£  Test Member Stats...');\n    try {\n      const memberStats = await api.memberCareerStats({\n        clubId: CLUB_ID,\n        platform: PLATFORM\n      });\n      \n      const hasMembers = memberStats && memberStats.members && Object.keys(memberStats.members).length > 0;\n      const memberCount = hasMembers ? Object.keys(memberStats.members).length : 0;\n      \n      results.tests.push({\n        name: 'Member Stats',\n        success: hasMembers,\n        data: hasMembers ? {\n          memberCount,\n          sampleMember: Object.values(memberStats.members)[0]\n        } : null\n      });\n      \n      console.log(`   ${hasMembers ? '‚úÖ Succ√®s' : '‚ùå √âchec'}: ${memberCount} membres trouv√©s`);\n    } catch (error) {\n      results.tests.push({\n        name: 'Member Stats',\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error'\n      });\n      console.log(`   ‚ùå Erreur: ${error}`);\n    }\n    \n    // Test 3: Matches\n    console.log('3Ô∏è‚É£  Test Matches...');\n    try {\n      const matches = await api.matchesStats({\n        clubIds: CLUB_ID,\n        platform: PLATFORM,\n        matchType: 'leagueMatch'\n      });\n      \n      const hasMatches = Array.isArray(matches) && matches.length > 0;\n      \n      results.tests.push({\n        name: 'Matches',\n        success: hasMatches,\n        data: hasMatches ? {\n          matchCount: matches.length,\n          sampleMatch: {\n            matchId: matches[0]?.matchId,\n            timestamp: matches[0]?.timestamp,\n            clubs: Object.keys(matches[0]?.clubs || {})\n          }\n        } : null\n      });\n      \n      console.log(`   ${hasMatches ? '‚úÖ Succ√®s' : '‚ùå √âchec'}: ${hasMatches ? matches.length : 0} matchs trouv√©s`);\n    } catch (error) {\n      results.tests.push({\n        name: 'Matches',\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error'\n      });\n      console.log(`   ‚ùå Erreur: ${error}`);\n    }\n    \n    const successfulTests = results.tests.filter((t: any) => t.success);\n    const summary = {\n      total: results.tests.length,\n      successful: successfulTests.length,\n      failed: results.tests.length - successfulTests.length\n    };\n    \n    console.log(`üéâ Test termin√©: ${summary.successful}/${summary.total} tests r√©ussis`);\n    \n    return NextResponse.json({\n      success: summary.successful >= 2, // Au moins 2/3 tests doivent r√©ussir\n      message: `Tests EA Sports: ${summary.successful}/${summary.total} r√©ussis`,\n      data: {\n        ...results,\n        summary\n      }\n    });\n    \n  } catch (error) {\n    console.error('‚ùå Erreur test librairie EA Sports:', error);\n    \n    return NextResponse.json(\n      { \n        success: false, \n        error: 'Erreur lors du test de la librairie EA Sports',\n        details: error instanceof Error ? error.message : 'Erreur inconnue'\n      },\n      { status: 500 }\n    );\n  }\n}\n